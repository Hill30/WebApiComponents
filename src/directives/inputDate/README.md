inputDate + datepicker
(c) dhilt, 2014

--------------------------------------------------

### Поведение компонента, поддерживаемое в настоящее время

1. Ввод даты с клавиатуры.
1.1. Ввод даты в textinput с клавиатуры в заданном формате без открытия попапа.
1.2. Autocommit (запись значения в модель конечного назначения) вводимой с клавиатуры даты в 4х режимах:
1.2.1 - мгновенная запись по факту изменения содержимого textinput'a (input);
1.2.2 - отложенная запись по факту изменения содержимого textinput'a (debouncedInput);
1.2.3 - мгновенная запись по потере textinput'ом фокуса (lostFocus);
1.2.4 - мгновенная запись по нажатию на enter (enter)
1.3. Autocommit-режимы можно комбинировать.
1.4. Отсутствие явного указания autocommit-режима соотв. случаю lostFocus (значение по умолчанию).

2. Работа с попапом (datepicker).
2.1. Попап можно открыть только кликом по иконке календаря.
2.2. Попап закрывается при клике вне себя и при клике по иконке календаря.
2.3. Попап закрывается при выборе даты.
2.4. Дата, выбранная в попапе, попадает в textinput в заданном формате.
2.5. Попап закрывается на нажатию на escape. Коммит даты в textinput не происходит. Фокус остается на textinput.
2.6. Попап закрывается по нажатию на tab. Коммит даты в textinput не происходит. Фокус смещается согласно элементам внешней формы, как если бы tab всплывал выше.
2.7. При нажатии left/right внутри попапа осуществляется навигация по месяцам (годам).
2.8. Кнопка Today, нажатие по которой приводит к выбору (и коммиту) сегодняшней даты и закрытию попапа.

3. Обратная связь с моделью конечного назначения.
3.1. Непосредственной слежки за изменением значения в исходной модели компонент не ведет.
3.2. Компонент узнает о внешнем изменении значения только посредством пробрасывания спец. объекта, содержащего сведения о требуемом изменении значения.
3.3. Также компонент подписан на изменение свойствя ng-disabled, позмоляющее извне управлять блокировкой работы компонента.

--------------------------------------------------

### Пример использования директивы в шаблоне (для serviceTracker'а)

```html
<input-date
    value="overrides.serviceDate"
    name="serviceDate"
    tabindex="5"
    autocommit="lostFocus, enter"
    update-from-ctrl="serviceDateUpdateFire"
    ng-disabled="readonly"
    ng-class="{'input-group-invalid': form.serviceDate.$error.dateValidator && isFormSubmited}"
</input-date>
```

--------------------------------------------------

### Примечания

1. В контроллере никакого дополнительного кода не нужно. Можно работать со значением ("value") <input-date> так, как если бы это было бы "ng-model" простого <input>. Оданко, следует помнить, что scope input-date изолирован и обратная связь с моделью конечного назначения очень ограничена.

2. Модель конечного назначения сообщает компоненту inputDate о изменении значения путем создания/изменения обекта, указанного через свойство "update-from-ctrl". Синтаксис следующий:

	serviceDateUpdateFire = {
		value: ""
	}

конкретно этот пример актуален, когда UI должен позволять очищать дату.

3. Валидация даты по формату в настоящей реализации внесена в код директивы (соответственно директива dateValidator больше не нужна; предлагается в дальнейшем генерализовать валидацию полей ввода путем введения универсального validationService). Всякий раз по записи значения в модель конечного назначения, на scope'е этой модели (а точнее на элементе формы этого scope'а, соответствующем параметру "name") вызывается следующий метод:

	$setValidity("dateValidator", isValid)

, где isValid - имеет тип boolean. При необходимости наименование валидатора можно параметризировать, чтобы оно также задавалось декларативно через шаблон.

4. Autocommit по отложенному вводу может конфигурироваться параметром задержки. Для этого реализован следующий синтаксис:

	autocommit="lostFocus, debouncedInput(500)"

Таким образом commit по вводу будет откладываться на полсекунды от момента последнего изменения textinput'а.



--------------------------------------------------

Описание предыдущих этапов работ над компонентом и связанных с этим трудностей можно найти в соседней ветке:

https://github.com/Hill30/WebApiComponents/blob/dev-datepicker-wrapper/src/directives/inputDate.txt